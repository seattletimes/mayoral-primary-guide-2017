<%
// merge data together
var candidates = [];
Object.keys(json.Candidates).forEach(function(k, i) {
  var candidate = json.Candidates[k];
  candidate.id = k;
  candidates.push(candidate);
  candidate.questions = json.Edited[k] || {};
});

%><!doctype html>
<html lang="en-US">
  <head>
    <%= t.include("partials/_head.html", grunt.data.json) %>
    <link rel="stylesheet" type="text/css" href="style.css">
  </head>
  <body>

    <%= t.include("partials/_nav.html") %>

    <%= t.include("partials/_ad.html", { type: "banner" }) %>

    <div class="constraint">

      <header>
        <h1>Mayoral primary guide</h1>
      </header>

      <main>
        <nav class="tab-group">
          <a href="#/candidates" class="candidates">Candidates</a>
          <a href="#/questions" class="questions">Questions</a>
          <a href="#/about" class="about">About</a>
        </nav>
        <div class="view-container">
          <%= t.include("js/_candidate-chooser.html", { data: { candidates }}) %>
        </div>
      </main>

    </div>

    <%= t.include("partials/_navBottom.html") %>

    <script>
window.candidateData = <%= JSON.stringify(candidates) %>;
window.questionData = <%= JSON.stringify(json.Questions) %>;
    </script>

    <script src="app.js" async></script>
    <% if (json.project.production) { %>
    <%= !json.project.embedded ? t.include("partials/_analytics.html") : "" %>
    <%= t.include("partials/_workHere.html") %>
    <% } %>
  </body>
</html>

<!doctype html>
<html lang="en-US">
  <head>
    <%= t.include("partials/_head.html", grunt.data.json) %>
    <link rel="stylesheet" type="text/css" href="style.css">
  </head>
  <body>

    <main class="app">
      <side-menu :candidates="candidates" :questions="questions"></side-menu>
      <router-view class="view-container" :candidates="candidates"></router-view>
    </main>

    <script>
<%
// merge data together
var candidates = [];
Object.keys(json.Candidates).forEach(function(k, i) {
  var candidate = json.Candidates[k];
  candidate.id = i;
  candidate.name = k;
  candidates.push(candidate);
  var match = json.Edited.filter(s => s.name == k).pop();
  if (!match) return;
  candidate.questions = json.Questions.map(q => ({ question: q.id, answer: match[q.id] }));
});

%>
window.candidateData = <%= JSON.stringify(candidates) %>;
window.questionData = <%= JSON.stringify(json.Questions) %>;
    </script>

    <script src="app.js" async></script>
    <% if (json.project.production) { %>
    <%= !json.project.embedded ? t.include("partials/_analytics.html") : "" %>
    <%= t.include("partials/_workHere.html") %>
    <% } %>
  </body>
</html>
